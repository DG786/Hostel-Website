if (self.CavalryLogger) { CavalryLogger.start_js(["oOyW0"]); }

__d('UFIReactionsDialogLayerImpl.react',['cx','csx','BrowserSupport','CSS','DataStore','DOM','DOMQuery','Layer','Locale','Parent','React','ReactDOM','ReactTransitionEvents','RTLKeys','Style','SubscriptionsHandler','TabbableElements','UFIConfig','Vector','ViewportBounds','ge','getElementPosition','getOverlayZIndex','memoize','renderSubtreeIntoContainer','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i){var j,k,l,m;if(c.__markCompiled)c.__markCompiled();var n=c('React').PropTypes,o="_1oxh",p="_2r6k",q="_2r6j",r=c('BrowserSupport').hasCSSAnimations(),s="_22un",t="_22uo",u={};j=babelHelpers.inherits(v,c('Layer'));k=j&&j.prototype;v.prototype.updatePosition=function(){'use strict';var x=this.getInsertParent(),y=this.getCausalElement(),z=c('Vector').getElementPosition(y),aa=c('Vector').getElementPosition(x),ba=z.sub(aa),ca=c('Vector').getElementDimensions(x).x;if(c('Locale').isRTL())ba.x=ca-ba.x;ba.x=Math.min(ba.x,c('Vector').getViewportDimensions().x-c('Vector').getElementDimensions(this.getContentRoot()).x);if(c('Locale').isRTL()){u.right=ba.x+'px';}else u.left=ba.x+'px';u.top=ba.y+'px';u.zIndex=c('getOverlayZIndex')(y,x);c('Style').apply(this.getRoot(),u);return true;};v.prototype.getContentRoot=function(){'use strict';return this.contentRoot;};v.prototype._buildWrapper=function(x,y){'use strict';c('CSS').addClass(y,"_49v-");this.contentRoot=y;var z=document.createElement('div');c('CSS').addClass(z,"_1oxj");z.appendChild(y);return z;};function v(){'use strict';j.apply(this,arguments);}l=babelHelpers.inherits(w,c('React').Component);m=l&&l.prototype;function w(x,y){'use strict';m.constructor.call(this,x,y);this.onTransitionHide=function(){c('ReactTransitionEvents').removeEndEventListener(this.layer.getContentRoot(),this.onTransitionHide);this.finishHide();}.bind(this);this.onTransitionShow=function(){var aa=this.layer.getContentRoot();c('ReactTransitionEvents').removeEndEventListener(aa,this.onTransitionShow);c('requestAnimationFrame')(function(){c('CSS').removeClass(aa,q);});}.bind(this);this.onKeyDown=function(event){var aa=event.keyCode;if(this.props.isScreenReader)return;if(aa===c('RTLKeys').ESC||aa===c('RTLKeys').RETURN||aa===c('RTLKeys').TAB){this.props.onLayerBlur&&this.props.onLayerBlur(event);var ba=c('ReactDOM').findDOMNode(this.refs.root),ca=c('TabbableElements').find(this.getContextualLayerParent()),da=null,ea=[],fa=aa===c('RTLKeys').TAB&&event.shiftKey;for(var ga=0;ga<ca.length;ga++)if(ca[ga].tabIndex>-1){if(ba.compareDocumentPosition(ca[ga])&4){da=ca[ga];break;}if(fa)ea.push(ca[ga]);}if(ea.length)da=ea[ea.length-1];if(da){da.focus();event.preventDefault();}}}.bind(this);this.getGlobalContainer=c('memoize')(function(){return c('ge')('globalContainer');});this.onParentLayerHide=this.finishHide.bind(this);var z=c('UFIConfig').reactionsHasPopupDockAnimation;this.dockAnimation=z?t:s;this.popupAnimationDuration=z?c('UFIConfig').reactionsPopupDockAnimationDuration/1000+'s':null;}w.prototype.componentDidMount=function(){'use strict';var x=c('ReactDOM').findDOMNode(this.refs.root);this.layer=new v({causalElement:x,insertParent:x},document.createElement('div'));c('DOM').appendContent(x,this.layer.getRoot());this.handler=new (c('SubscriptionsHandler'))();if(this.props.onLayerBlur)this.handler.addSubscriptions(this.layer.subscribe('blur',this.props.onLayerBlur));this.handler.addSubscriptions(this.layer.subscribe('beforeshow',this.beforeShow.bind(this)),this.layer.subscribe('aftershow',this.afterShow.bind(this)),this.layer.subscribe('starthide',this.startHide.bind(this)));if(this.isInDocument())this.renderLayer();};w.prototype.componentDidUpdate=function(x){'use strict';this.renderLayer();};w.prototype.componentWillUnmount=function(){'use strict';if(this.layer){var x=this.layer.getContentRoot();c('ReactDOM').unmountComponentAtNode(this.layer.getContentRoot());c('ReactTransitionEvents').removeEndEventListener(x,this.onTransitionHide);c('ReactTransitionEvents').removeEndEventListener(x,this.onTransitionShow);this.handler.release();this.handler=null;this.layer.destroy();this.layer=null;}};w.prototype.isInDocument=function(){'use strict';var x=c('ReactDOM').findDOMNode(this.refs.root);return x&&document.body.contains(x);};w.prototype.afterShow=function(){'use strict';var x=c('TabbableElements').find(this.layer.getContentRoot())[0];x&&x.focus();c('CSS').removeClass(this.refs.root,'accessible_elem');var y=this.layer.getContentRoot(),z=c('getElementPosition')(y).y,aa=c('ViewportBounds').getTop();c('CSS').conditionClass(y,o,z&&z<aa);if(r){c('ReactTransitionEvents').addEndEventListener(y,this.onTransitionShow);if(this.popupAnimationDuration)c('DOMQuery').scry(y,"._iuw").forEach(function(ba){ba.style.animationDuration=this.popupAnimationDuration;}.bind(this));c('CSS').addClass(y,this.dockAnimation);c('CSS').addClass(y,q);}};w.prototype.beforeShow=function(){'use strict';var x=this.getContextualLayerParent();if(this.props.isScreenReader){this.layer.setInsertParent(this.layer.getCausalElement());}else if(x!==this.layer.getInsertParent()){this.layer.setInsertParent(x);this.setParentLayerSubscription(x);}};w.prototype.setParentLayerSubscription=function(x){'use strict';if(x!==this.getGlobalContainer()){this.parentLayerSubscription&&this.parentLayerSubscription.unsubscribe();this.parentLayer=null;return;}var y=x,z=null;while(y!==null){z=c('DataStore').get(y,'layer');if(z)break;y=y.parentNode;}if(z&&z!==this.parentLayer){this.parentLayerSubscription&&this.parentLayerSubscription.unsubscribe();this.parentLayerSubscription=z.subscribe('hide',this.onParentLayerHide);this.parentLayer=z;}};w.prototype.startHide=function(){'use strict';if(r&&this.isInDocument()){var x=this.layer.getContentRoot();c('ReactTransitionEvents').addEndEventListener(x,this.onTransitionHide);c('CSS').addClass(x,p);}else this.finishHide();return false;};w.prototype.finishHide=function(){'use strict';c('CSS').addClass(this.refs.root,'accessible_elem');var x=this.layer.getContentRoot();if(r){c('CSS').removeClass(x,o);c('CSS').removeClass(x,p);c('CSS').removeClass(x,this.dockAnimation);if(this.popupAnimationDuration)c('DOMQuery').scry(x,"._iuw").forEach(function(y){y.style.animationDuration=null;});}this.layer.setInsertParent(this.layer.getCausalElement());this.layer.finishHide();};w.prototype.getContextualLayerParent=function(){'use strict';return c('Parent').byClass(c('ReactDOM').findDOMNode(this.refs.root),'uiContextualLayerParent')||document.body;};w.prototype.renderLayer=function(){'use strict';c('renderSubtreeIntoContainer')(this,c('React').createElement('div',babelHelpers['extends']({},this.props,{className:"_1oxk",onKeyDown:this.onKeyDown}),this.props.children,c('React').createElement('div',{className:"_41nt"+(this.props.isDarkBackground?' '+"_3_jc":'')+(this.props.hasSquareCorner?' '+"_2lqi":''),style:{height:this.props.height}})),this.layer.getContentRoot());this.layer.conditionShow(this.props.shown);};w.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_2r6l accessible_elem",ref:'root'}));};w.propTypes={shown:n.bool,isScreenReader:n.bool};f.exports=w;},null);
__d('UFIReactionsMenuImpl.react',['cx','fbt','Event','Locale','RTLKeys','React','ReactDOM','SubscriptionsHandler','UFIConfig','UFIReactionsTheme','UFIReactionIconImpl.react','UFIReactionTypes','UFIReactionsDialogLayerImpl.react','UFIReactionsThemeStoreButton.react','addFocusEvents','getVendorPrefixedName','joinClasses','shallowCompare'],function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l=8,m=96,n=48,o=44,p=c('UFIReactionTypes').reactions,q=c('getVendorPrefixedName')('transform'),r=i._("Reactions"),s=c('addFocusEvents')('span');j=babelHelpers.inherits(t,c('React').Component);k=j&&j.prototype;function t(u,v){'use strict';k.constructor.call(this);this.focusSelected=function(){var y=c('ReactDOM').findDOMNode(this.refs[this.state.selectedIndex]);if(y)y.focus();}.bind(this);this.onDragStart=function(event){event.preventDefault();};this.onKeyDown=function(event){switch(event.keyCode){case c('RTLKeys').RETURN:event.preventDefault();var y=this.state.supportedReactions[this.state.selectedIndex];if(this.props.initialReaction===y)y=c('UFIReactionTypes').NONE;if(y!==null&&y!==undefined&&this.props.onReactionClick)this.props.onReactionClick(y,event);break;case c('RTLKeys').getLeft():case c('RTLKeys').getRight():event.preventDefault();this.setState({selectedIndex:Math.max(0,Math.min(this.state.selectedIndex+(event.keyCode===c('RTLKeys').getLeft()?-1:1),this.state.supportedReactions.length-1))},this.focusSelected);break;}}.bind(this);this.onThemeStoreShow=function(){this.setState({persistLayer:true});}.bind(this);this.onThemeStoreHide=function(){this.setState({persistLayer:false});}.bind(this);var w=u.supportedReactions.filter(function(y){return p[y];}),x=u.allowKeyboardFocus?Math.max(0,w.indexOf(u.initialReaction)):-1;this.state={persistLayer:false,hasKeyboardFocus:u.allowKeyboardFocus,selectedIndex:x,supportedReactions:w,theme:c('UFIReactionsTheme').getThemeClassName()};c('UFIReactionsTheme').subscribe('change',function(){this.setState({theme:c('UFIReactionsTheme').getThemeClassName()});}.bind(this));this.hasStaticSVGDock=c('UFIConfig').reactionsHasStaticFileVectorDock;this.hasAnimatedIconsOnHover=c('UFIConfig').reactionsHasAnimatedIconsOnHover;}t.prototype.componentWillReceiveProps=function(u){'use strict';if(!u.shown&&this.props.shown)this.setState({hasKeyboardFocus:u.allowKeyboardFocus,selectedIndex:-1});this.setState({supportedReactions:u.supportedReactions.filter(function(v){return p[v];})});};t.prototype.componentDidMount=function(){'use strict';if(this.props.allowKeyboardFocus)this.focusSelected();};t.prototype.componentDidUpdate=function(u,v){'use strict';if(this.props.allowKeyboardFocus&&!u.allowKeyboardFocus)this.focusSelected();if(this.props.isLongPressing&&!u.isLongPressing){var w,x=new (c('SubscriptionsHandler'))();x.addSubscriptions(c('Event').listen(document.documentElement,'touchmove',function(event){event.preventDefault();var y=event.touches[0],z=document.elementFromPoint(y.clientX,y.clientY);if(!z.getAttribute('data-reaction')&&z.parentElement)z=z.parentElement;var aa=parseInt(z.getAttribute('data-reaction'),10)||null;if(aa!==w){if(w)this.onReactionMouseLeave(w,event);if(aa)this.onReactionMouseEnter(aa,event);w=aa;}}.bind(this)),c('Event').listen(document.documentElement,'touchend',function(event){if(w)this.onReactionClick(w,event);if(x){x.release();x=null;}}.bind(this)));}};t.prototype.shouldComponentUpdate=function(u,v){'use strict';return c('shallowCompare')(this,u,v);};t.prototype.onKeyboardFocus=function(u,event){'use strict';this.setState({hasKeyboardFocus:true,selectedIndex:u});this.props.onFocus&&this.props.onFocus(event);};t.prototype.onReactionClick=function(u,event){'use strict';event.preventDefault();this.props.onReactionClick&&this.props.onReactionClick(u,event);};t.prototype.onReactionMouseEnter=function(u,event){'use strict';this.setState({selectedIndex:this.props.supportedReactions.indexOf(u)});this.props.onReactionMouseEnter&&this.props.onReactionMouseEnter(u);};t.prototype.onReactionMouseLeave=function(u,event){'use strict';this.setState({selectedIndex:-1});this.props.onReactionMouseLeave&&this.props.onReactionMouseLeave(u);};t.prototype.renderThemesButton=function(){'use strict';if(!c('UFIConfig').reactionsHasThemes)return null;return (c('React').createElement(c('UFIReactionsThemeStoreButton.react'),{onShow:this.onThemeStoreShow,onHide:this.onThemeStoreHide}));};t.prototype.render=function(){'use strict';var u=this.state.supportedReactions.length,v=c('UFIConfig').reactionsHasMegaDock&&!this.props.noMegaDock&&u>2,w=(u*n-m)/(u-1),x=this.state.selectedIndex,y=this.state.supportedReactions.map(function(z,aa){var ba=p[z].display_name,ca=this.onReactionClick.bind(this,z),da=Math.max(0,this.state.supportedReactions.indexOf(this.props.initialReaction))===aa,ea=null;if(v&&x!==-1){var fa,ga=(x===aa?m:w)/m,ha=0;if(aa<x){ha=-(n-n*ga+(n-m*ga)*aa);}else if(aa>x){ha=(n-w)*(u/2-aa);}else ha=-(n*aa-w*aa);if(c('Locale').isRTL())ha=-ha;ea=(fa={},fa[q]='translateX('+Math.floor(ha)+'px) scale('+ga+')',fa);}var ia,ja=this.props.icon;if(ja&&x===aa&&this.hasAnimatedIconsOnHover){ia=c('React').createElement(ja,{animate:this.props.shown,selectedIndex:this.state.selectedIndex,maxSize:v?m:n,reaction:p[z].name,vectors:this.props.vectors});}else ia=c('React').createElement(c('UFIReactionIconImpl.react'),{className:c('joinClasses')(this.state.theme,"_2jry"+(this.props.suggestedReaction&&c('UFIConfig').reactionsHasDockSuggestions&&z===this.props.suggestedReaction&&z!==c('UFIReactionTypes').LIKE?' '+"_4g49":'')),reaction:z,size:v?'96':'48',hasStaticSVGDock:this.hasStaticSVGDock});return (c('React').createElement(s,{'aria-pressed':this.props.initialReaction===z,'aria-label':ba,className:"_iuw"+(x===aa?' '+"_iuy":''),href:'#',key:'reaction_'+z,onClick:ca,onDragStart:this.onDragStart,onKeyboardFocus:this.onKeyboardFocus.bind(this,aa),onMouseUp:this.props.onReactionMouseUp,onMouseDown:this.props.onReactionMouseDown,onMouseEnter:this.onReactionMouseEnter.bind(this,z),onMouseLeave:this.onReactionMouseLeave.bind(this,z),onTouchStart:this.onDragStart,onTouchEnd:ca,ref:aa,role:'button',tabIndex:da&&(!this.props.shown||x===aa)?0:-1},c('React').createElement('div',{className:"_39m",'data-reaction':z},c('React').createElement('div',{className:"_39n",style:ea},ia,c('React').createElement('div',{className:"_d6l"},c('React').createElement('div',{className:"_4sm1"},ba))))));}.bind(this));return (c('React').createElement(c('UFIReactionsDialogLayerImpl.react'),{hasSquareCorner:c('UFIConfig').reactionsHasThemes,height:(v?x!==-1?w:n:o)+l,isDarkBackground:this.props.isDarkBackground,isScreenReader:this.props.isScreenReader,onLayerBlur:!this.state.persistLayer&&this.props.onBlur,onMouseEnter:this.props.onMouseEnter,onMouseLeave:!this.state.persistLayer&&this.props.onMouseLeave,shown:this.props.shown},c('React').createElement('div',{className:"_iu-"+(this.state.hasKeyboardFocus?' '+"_5wkt":'')+(v?' '+"_17hc":''),onKeyDown:this.onKeyDown,'aria-label':r,ref:'root',role:'toolbar'},y),this.renderThemesButton()));};f.exports=t;},null);